(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[369],{60888:function(e,t,n){"use strict";var r=n(95318);t.Z=void 0;var a=r(n(64938)),i=n(85893),c=(0,a.default)((0,i.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle");t.Z=c},73381:function(e,t,n){"use strict";var r=n(95318);t.Z=void 0;var a=r(n(64938)),i=n(85893),c=(0,a.default)((0,i.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6-6-6z"}),"ChevronRightOutlined");t.Z=c},42761:function(e,t,n){"use strict";var r=n(95318);t.Z=void 0;var a=r(n(64938)),i=n(85893),c=(0,a.default)((0,i.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");t.Z=c},25802:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(67294),a=n(76798),i=n(59499),c=n(15568),o=n(85893);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var l=r.forwardRef((function(e,t){return(0,o.jsx)(c.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({elevation:6,ref:t,variant:"filled"},e))})),_=l,u=n(77227),d=function(e){var t=e.open;return(0,o.jsx)(u.Z,{sx:{color:"#fff",zIndex:9999},open:t,children:(0,o.jsx)("img",{src:"/loadingWhite.svg",style:{width:100,height:100},alt:"img"})})},v=n(37196),m=n.n(v),f=function(e){var t=e.openSnack,n=e.snackMsg,r=e.alertType,i=e.openLoading,c=e.onClose;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d,{open:i}),(0,o.jsx)(a.Z,{open:t,anchorOrigin:{vertical:"top",horizontal:"right"},className:m().snack_area,autoHideDuration:3e3,onClose:c,children:(0,o.jsx)(_,{onClose:c,sx:{width:"100%"},severity:r,children:n})})]})}},95509:function(e,t,n){"use strict";n(67294);var r=n(96538),a=n.n(r),i=n(16573),c=n(1020),o=n(46616),s=n(87385),l=n(38168),_=n(44276),u=n(48137),d=n(66339),v=n(43800),m=n(86983),f=n(87357),h=n(15861),p=n(85893),g={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:400,bgcolor:"#fff",borderRadius:"24px",boxShadow:24,p:4,outline:"none",paddingTop:"20px"};t.Z=function(e){var t=e.link;return(0,p.jsx)(m.Z,{open:!0,onClose:e.onCloseModal,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,p.jsxs)(f.Z,{sx:g,children:[(0,p.jsx)(h.Z,{id:"modal-modal-title",variant:"h6",component:"h2",textAlign:"center",children:"Share this event"}),(0,p.jsx)("div",{className:a().line_gradient}),(0,p.jsxs)("div",{className:a().container,children:[(0,p.jsxs)(i.Z,{url:t,quote:title,className:a().container_network,children:[(0,p.jsx)(c.Z,{size:32,round:!0}),(0,p.jsx)("div",{className:a().container_network_title,children:"Facebook"})]}),(0,p.jsxs)(o.Z,{url:t,title:title,className:a().container_network,children:[(0,p.jsx)(s.Z,{size:32,round:!0}),(0,p.jsx)("div",{className:a().container_network_title,children:"Twitter"})]}),(0,p.jsxs)(l.Z,{url:t,title:title,className:a().container_network,children:[(0,p.jsx)(_.Z,{size:32,round:!0}),(0,p.jsx)("div",{className:a().container_network_title,children:"Telegram"})]}),(0,p.jsxs)(u.Z,{url:t,title:title,className:a().container_network,children:[(0,p.jsx)(d.Z,{size:32,round:!0}),(0,p.jsx)("div",{className:a().container_network_title,children:"Email"})]}),(0,p.jsxs)("button",{className:a().container_network,onClick:function(){navigator.clipboard.writeText(t),e.onCloseModal(),e.onSuccess()},children:[(0,p.jsx)("div",{className:a().container_network_icon,children:(0,p.jsx)(v.Z,{className:a().container_network_icon_svg})}),(0,p.jsx)("div",{className:a().container_network_title,children:"Copy link"})]})]})]})})}},81104:function(e,t,n){"use strict";n.r(t);var r=n(59499),a=n(50029),i=n(9632),c=n(87794),o=n.n(c),s=n(67294),l=n(51654),_=n.n(l),u=n(42761),d=n(73381),v=n(59739),m=n(91811),f=n(36111),h=n(60888),p=n(11163),g=n(95509),x=n(25617),j=n(25802),w=n(8791),y=n(85893),b=n(34155);function k(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){o=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(o)throw i}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(e){var t=e.item,n=e.onGetSharedLink,r=e.renderInterestedIcon,i=(0,p.useRouter)(),c=(0,s.useState)(""),l=c[0],u=c[1];(0,s.useEffect)((function(){d()}),[]);var d=function(){var e=(0,a.Z)(o().mark((function e(){var n,r,a,i,c,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.cover_image||""===t.cover_image||"/calendar.svg"!==t.img){e.next=11;break}return n=new w.xk({token:b.env.NEXT_PUBLIC_w3key}),e.next=4,n.get(t.cover_image);case 4:if(!(r=e.sent).ok){e.next=11;break}return e.next=8,r.files();case 8:a=e.sent,i=k(a);try{for(i.s();!(c=i.n()).done;)s=c.value,(l=new FileReader).onload=function(e){u(e.target.result)},l.readAsDataURL(s)}catch(o){i.e(o)}finally{i.f()}case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,y.jsxs)("div",{className:_().event_item,children:[(0,y.jsxs)("div",{className:_().event_item_header,children:[(0,y.jsx)("div",{className:_().event_item_type,children:t.type}),(0,y.jsx)("img",{src:l,className:_().event_item_img,alt:"img",onClick:function(){return i.push("/event/event-detail?id=".concat(t.id))}})]}),(0,y.jsxs)("div",{className:_().event_item_info,children:[(0,y.jsx)("div",{className:_().event_item_date,children:t.date}),(0,y.jsx)("div",{className:_().event_item_name,onClick:function(){return i.push("/event/event-detail?id=".concat(t.id))},children:t.name}),(0,y.jsxs)("div",{className:_().event_item_footer,children:[(0,y.jsxs)("div",{className:_().event_item_attendees,children:[t.attendees," attendees"]}),(0,y.jsx)(v.Z,{className:_().event_item_icon,onClick:function(){n(t.id)}}),r(t)]})]})]},t.id)};t.default=function(){var e=(0,p.useRouter)(),t=(0,s.useState)("both"),n=(t[0],t[1],(0,s.useState)(!1)),r=n[0],c=n[1],l=(0,s.useState)(""),N=l[0],E=l[1],Z=(0,s.useState)([]),C=Z[0],I=Z[1],P=(0,s.useState)([]),A=P[0],L=P[1],D=(0,s.useState)({}),M=D[0],T=D[1],z=(0,s.useState)(!1),R=z[0],U=z[1],F=(0,s.useState)(!1),Y=F[0],q=F[1],B=(0,s.useState)("success"),G=B[0],X=B[1],W=(0,s.useState)(""),H=W[0],K=W[1],Q=(0,s.useState)(""),V=Q[0],J=Q[1],$=(0,s.useState)(!1),ee=$[0],te=$[1],ne=(0,s.useState)([]),re=ne[0],ae=ne[1],ie=(0,x.v9)((function(e){return e.wallet})),ce=[],oe=(0,s.useRef)([]);(0,s.useEffect)((function(){"[]"===JSON.stringify(A)||ee||(_e(),te(!0))}),[A]),(0,s.useLayoutEffect)((function(){fe()}),[]),(0,s.useLayoutEffect)((function(){ve()}),[]);var se=function(e){var t=e.type,n=e.msg;q(!0),U(!1),X(t),K(n)};(0,s.useEffect)((function(){re!==[]&&re.map((function(e){return L((0,i.Z)(A).map((function(t){return t.id===e&&(t.isInterested=!0),t}))),e}))}),[re]);var le=function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i,c,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T(O({},t)),"undefined"===typeof t.cover_image||""===t.cover_image){e.next=12;break}return n=new w.xk({token:b.env.NEXT_PUBLIC_w3key}),e.next=5,n.get((null===t||void 0===t?void 0:t.cover_image)||"");case 5:if(!(r=e.sent).ok){e.next=12;break}return e.next=9,r.files();case 9:a=e.sent,i=k(a);try{for(i.s();!(c=i.n()).done;)s=c.value,(l=new FileReader).readAsDataURL(s),l.onload=function(e){t.img=e.target.result,T(O({},t))}}catch(o){i.e(o)}finally{i.f()}case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_e=function(){var e,t=ie.contract,n=ie.walletConnection.getAccountId();null===t||void 0===t||null===(e=t.get_interested_event_count)||void 0===e||e.call(t,{userId:n}).then((function(e){ue({total:e})})).catch((function(e){console.log(e)}))},ue=function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,i,c,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.total,r=ie.contract,i=ie.walletConnection,c=n%5===0?n/5:parseInt(n/5)+1,s=new Array(c).fill(0),l=i.getAccountId(),e.next=7,Promise.all(s.map(function(){var e=(0,a.Z)(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.get_interested_events({userId:l,page:n+1}).then((function(e){if(e){var t=[];e.data.map((function(e){t.push(e.id)})),ae(t)}}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(e){var t="Online";switch(e.event_type){case 1:t="In person";break;case 2:t="Online + In person"}return{id:e.id,owner:e.owner,name:e.name,type:t,date:he(e.start_date),end_timestamp:e.end_date,date_timestamp:e.start_date,attendees:e.participants.length,cover_image:e.cover_image,img:"/calendar.svg",isInterested:!1}},ve=function(){var e,t=ie.contract;oe.current=[],null===t||void 0===t||null===(e=t.get_newest_events)||void 0===e||e.call(t,{}).then(function(){var e=(0,a.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return n=Date.now(),e.next=4,t.data.map(function(){var e=(0,a.Z)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=de(t)).end_timestamp>n&&oe.current.push(r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:oe.current.sort((function(e,t){return e.date_timestamp-t.date_timestamp})),L((0,i.Z)(oe.current));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},me=function(e){var t=ie.contract;ie.walletConnection.getAccountId()!==e.owner?(U(!0),null===t||void 0===t||t.interest_event({eventId:e.id},5e13).then((function(t){t?(se({type:"success",msg:t}),e.isInterested="Interested"===t,L((0,i.Z)(A).map((function(t){return t.id===e.id?e:t})))):se({type:"error",msg:"Error when interested"})})).catch((function(e){se({type:"error",msg:String(e)})}))):se({type:"error",msg:"You are the owner of this event"})},fe=function(){var e,t=ie.contract,n=ie.walletConnection.getAccountId();null===t||void 0===t||null===(e=t.get_event_count)||void 0===e||e.call(t,{userId:n}).then((function(e){pe({total:e})})).catch((function(e){console.log(e)}))},he=function(e){try{var t=parseFloat(e),n=new Date(t),r=n.toLocaleDateString(),a=n.toLocaleTimeString();return"".concat(r," @ ").concat(a)}catch(i){return"unknow"}},pe=function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,i,c,s,l,_;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.total,r=ie.contract,i=ie.walletConnection,c=n%5===0?n/5:parseInt(n/5)+1,s=new Array(c).fill(0),l=i.getAccountId(),_=Date.now(),e.next=8,Promise.all(s.map(function(){var e=(0,a.Z)(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.get_events({userId:l,page:n+1}).then((function(e){if(e){var t,n={img:"/calendar.svg"},r=-1;null===e||void 0===e||null===(t=e.data)||void 0===t||t.map((function(e){var t="Online";switch(null===e||void 0===e?void 0:e.event_type){case 1:t="In person";break;case 2:t="Online + In person"}var a={id:e.id,name:e.name,type:t,date:he(e.start_date),attendees:e.participants.length,cover_image:e.cover_image};ce.push(a);var i=_-e.start_date;return(-1===r||i<r)&&(r=i),n={id:e.id,name:e.name,type:t,start_date:e.start_date,date:he(e.start_date),attendees:e.participants.length,cover_image:e.cover_image,img:"/calendar.svg"},e})),le(n),C.length<9&&I([].concat(ce))}}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(e){return e.isInterested?(0,y.jsx)(f.Z,{className:_().event_item_icon_favor,onClick:function(){return me(e)}}):(0,y.jsx)(m.Z,{className:_().event_item_icon_favor,onClick:function(){return me(e)}})},xe=function(e){var t=new URL(window.location.href).origin;J("".concat(t,"/event/event-detail?id=").concat(e)),c(!0)};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(j.Z,{openLoading:R,openSnack:Y,alertType:G,snackMsg:H,onClose:function(){q(!1)}}),(0,y.jsxs)("div",{className:_().root,children:[(0,y.jsx)("div",{className:_().label_create,children:"Start to create your event"}),(0,y.jsx)("button",{className:_().button_create,onClick:function(){e.push("/event/create-event")},children:"Create Event"}),(0,y.jsxs)("div",{className:_().label,children:[(0,y.jsx)("div",{className:_().label_title,children:"Your next event"}),(0,y.jsxs)("div",{className:_().label_text,onClick:function(){return e.push("/event/my-event")},children:["More events you're attending ",(0,y.jsx)(d.Z,{className:_().icon_collapse})]})]}),(0,y.jsx)("div",{className:_().line}),M.id&&null!==M.id?(0,y.jsxs)("div",{className:_().attend_event,children:[(0,y.jsxs)("div",{className:_().attend_item_header,children:[(0,y.jsx)("div",{className:_().attend_item_type,children:"Online"}),(0,y.jsx)("img",{src:M.img,className:_().attend_item_img,alt:"img"})]}),(0,y.jsxs)("div",{className:_().attend_item_info,onClick:function(){return e.push("/event/event-detail?id=".concat(M.id))},children:[(0,y.jsx)("div",{className:_().attend_item_date,children:he(M.start_date)}),(0,y.jsx)("div",{className:_().attend_item_name,children:M.name})]}),(0,y.jsxs)("div",{className:_().attend_item_footer,children:[(0,y.jsxs)("div",{className:_().attending,children:[(0,y.jsx)(h.Z,{className:_().attending_icon}),"Attending"]}),(0,y.jsx)(v.Z,{className:_().attend_item_icon,onClick:function(){return xe(M.id)}})]})]}):(0,y.jsx)("div",{className:_().attend_event_nothing,children:"You don't have any events"}),(0,y.jsx)("div",{className:_().label,children:(0,y.jsx)("div",{className:_().label_title,children:"Find your event"})}),(0,y.jsxs)("div",{className:_().search_row,children:[(0,y.jsxs)("div",{className:_().search_area,children:[(0,y.jsx)("input",{placeholder:"Find your event",className:_().input_search,value:N,onChange:function(e){E(e.currentTarget.value)}}),(0,y.jsx)(u.Z,{className:_().search_icon})]}),(0,y.jsx)("button",{className:_().button_search,onClick:function(){var t;""!==(t=N)&&e.push("/event/event-detail?id=".concat(t))},children:"Search"})]}),(0,y.jsxs)("div",{className:_().label,children:[(0,y.jsx)("div",{className:_().label_title,children:"Attend upcoming events"}),(0,y.jsxs)("div",{className:_().label_text,onClick:function(){return e.push("/event/more-events")},children:["More events ",(0,y.jsx)(d.Z,{className:_().icon_collapse})]})]}),(0,y.jsx)("div",{className:_().line}),(0,y.jsx)("div",{className:_().list_event,children:A.map((function(e){return(0,y.jsx)(S,{item:e,onGetSharedLink:xe,renderInterestedIcon:ge},e.id)}))}),r&&(0,y.jsx)(g.Z,{link:V,onCloseModal:function(){c(!1)},onSuccess:function(){se({type:"success",msg:"copied"})}})]})]})}},54789:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/event",function(){return n(81104)}])},37196:function(e){e.exports={snack_area:"Notify_snack_area__VKRcf"}},96538:function(e){e.exports={container:"Share_container__HK0Kf",container_network:"Share_container_network__d7E0n",container_network_title:"Share_container_network_title__vnpou",container_network_icon:"Share_container_network_icon__t1RMB",container_network_icon_svg:"Share_container_network_icon_svg__qAnU_",line_gradient:"Share_line_gradient__A0WlO"}},51654:function(e){e.exports={root:"Event_root__ehhPU",label_create:"Event_label_create__Wlx05",button_create:"Event_button_create__nmNlg",label:"Event_label__Px7If",label_title:"Event_label_title__GNMq8",search_row:"Event_search_row__oMbmq",search_area:"Event_search_area__CtwKp",input_search:"Event_input_search__ua2lU",search_icon:"Event_search_icon__EJiC3",input_location:"Event_input_location__ijxti",button_select:"Event_button_select__1_orx",button_search:"Event_button_search__zBLr5",label_text:"Event_label_text__cgCwv",icon_collapse:"Event_icon_collapse__hpvYO",line:"Event_line__hIGC_",list_event:"Event_list_event__lHkt4",event_item:"Event_event_item__l7aeq",event_item_header:"Event_event_item_header__Ge7mE",event_item_type:"Event_event_item_type___4v0I",event_item_img:"Event_event_item_img__MkfRv",event_item_info:"Event_event_item_info__rNbmN",event_item_date:"Event_event_item_date__Dhs2V",event_item_name:"Event_event_item_name__hewY_",event_item_footer:"Event_event_item_footer__FB1BW",event_item_attendees:"Event_event_item_attendees__adVe5",event_item_icon:"Event_event_item_icon__HBZqC",event_item_icon_favor:"Event_event_item_icon_favor__t_MCO",attend_event:"Event_attend_event__ytaYz",attend_item_header:"Event_attend_item_header__uh3nT",attend_item_type:"Event_attend_item_type__qfuh3",attend_item_img:"Event_attend_item_img__X7gYq",attend_item_info:"Event_attend_item_info__NGYxS",attend_item_date:"Event_attend_item_date__XyBNc",attend_item_name:"Event_attend_item_name__Q67QT",attend_item_footer:"Event_attend_item_footer__F3k7z",attend_item_icon:"Event_attend_item_icon__nAnyL",attending:"Event_attending__6dQUc",attending_icon:"Event_attending_icon__UT704",line_gradient:"Event_line_gradient__YuIGU",attend_event_nothing:"Event_attend_event_nothing__E4hjI"}}},function(e){e.O(0,[7739,6775,5334,1357,9774,2888,179],(function(){return t=54789,e(e.s=t);var t}));var t=e.O();_N_E=t}]);