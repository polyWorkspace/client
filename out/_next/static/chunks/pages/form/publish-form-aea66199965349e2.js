(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8714],{25802:function(e,t,i){"use strict";i.d(t,{Z:function(){return d}});var s=i(67294),l=i(76798),n=i(59499),_=i(15568),u=i(85893);function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}var o=s.forwardRef((function(e,t){return(0,u.jsx)(_.Z,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({elevation:6,ref:t,variant:"filled"},e))})),r=o,c=i(77227),h=function(e){var t=e.open;return(0,u.jsx)(c.Z,{sx:{color:"#fff",zIndex:9999},open:t,children:(0,u.jsx)("img",{src:"/loadingWhite.svg",style:{width:100,height:100},alt:"img"})})},b=i(37196),p=i.n(b),d=function(e){var t=e.openSnack,i=e.snackMsg,s=e.alertType,n=e.openLoading,_=e.onClose;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(h,{open:n}),(0,u.jsx)(l.Z,{open:t,anchorOrigin:{vertical:"top",horizontal:"right"},className:p().snack_area,autoHideDuration:3e3,onClose:_,children:(0,u.jsx)(r,{onClose:_,sx:{width:"100%"},severity:s,children:i})})]})}},71815:function(e,t,i){"use strict";i.r(t);var s=i(9632),l=i(67294),n=i(53444),_=i.n(n),u=i(73340),a=i(63845),o=i(60888),r=i(36185),c=i(59739),h=i(86983),b=i(87357),p=i(15861),d=i(87918),m=i(11496),f=i(11163),v=i(25617),x=i(25802),j=i(68447),g=i(85893),P={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:600,bgcolor:"#fff",borderRadius:"24px",boxShadow:24,p:4,outline:"none"};t.default=function(){var e=(0,v.v9)((function(e){return e.wallet})),t=(0,f.useRouter)(),i=t.query,n=(0,l.useState)("private"),N=n[0],y=n[1],w=(0,l.useState)(!1),k=w[0],S=w[1],C=(0,l.useState)(!0),O=C[0],Z=C[1],E=(0,l.useState)("0"),F=E[0],R=E[1],T=(0,l.useState)(0),I=T[0],D=T[1],L=(0,l.useState)([]),A=L[0],z=L[1],B=(0,l.useState)([]),H=B[0],U=B[1],V=(0,l.useState)(""),X=V[0],Y=V[1],M=(0,l.useState)(""),W=M[0],J=M[1],K=(0,l.useState)(""),q=K[0],G=K[1],Q=(0,l.useState)(""),$=Q[0],ee=Q[1],te=(0,l.useState)(!1),ie=te[0],se=te[1],le=(0,l.useState)(!1),ne=le[0],_e=le[1],ue=(0,l.useState)("success"),ae=ue[0],oe=ue[1],re=(0,l.useState)(""),ce=re[0],he=re[1],be=(0,l.useState)(""),pe=be[0],de=be[1],me=function(e){var t=e.type,i=e.msg;_e(!0),se(!1),oe(t),he(i)};(0,l.useEffect)((function(){return fe(),function(){localStorage.removeItem("myForms")}}),[]);var fe=function(){var s,l=e.contract,n=(e.walletConnection,i.id),_="",u=encodeURIComponent(_);null!==n&&""!==n&&"undefined"!==typeof n||(_="Could not found any object have that id!",t.push("/error?content=".concat(u))),null===l||void 0===l||null===(s=l.get_form)||void 0===s||s.call(l,{id:n}).then((function(i){if(i){var s,l=i.owner;(null===e||void 0===e||null===(s=e.accounts[0])||void 0===s?void 0:s.address)!==l&&(_="You do not have permssion to edit this form!"),0!==i.status&&(_="Form has been published before!"),""!==_&&(u=encodeURIComponent(_),t.push("/error?content=".concat(u)))}})).catch((function(e){console.log(e)}))},ve=function(){S(!1)},xe=function(){if(F<0)return me({type:"error",msg:"enroll fee could be negative"}),!1;if(I<0)return me({type:"error",msg:"limited participant could be negative"}),!1;if(""===X||"undefined"===typeof X||null===X)return me({type:"error",msg:"starting time could not be empty"}),!1;if(""===$||"undefined"===typeof $||null===$)return me({type:"error",msg:"ending date could not be empty"}),!1;if($<X)return me({type:"error",msg:"ending date could not less than starting date"}),!1;var e=Date.now();return!($<e)||(me({type:"error",msg:"ending date could not less than current time"}),!1)},je=function(e){if(N===e){var t="publish_status_content_active_"+e;return _()[t]}},ge=(0,m.ZP)("div")((function(e){return{margin:e.theme.spacing(1)}}));return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(x.Z,{openLoading:ie,openSnack:ne,alertType:ae,snackMsg:ce,onClose:function(){_e(!1)}}),(0,g.jsxs)("div",{className:_().root,children:[(0,g.jsxs)("div",{className:_().publish_content,children:[(0,g.jsxs)("div",{className:_().publish_title,children:[(0,g.jsx)("div",{className:_().publish_title_text,children:"Publish Form"}),(0,g.jsx)("div",{className:_().publish_title_status,children:function(){switch(N){case"private":return(0,g.jsxs)("div",{className:_().publish_title_button,children:[(0,g.jsx)(a.Z,{className:_().icon_lock}),"Private Form"]});case"public":return(0,g.jsxs)("div",{className:_().publish_title_button_public,children:[(0,g.jsx)(u.Z,{className:_().icon_lock}),"Public Form"]});case"share":return(0,g.jsxs)("div",{className:_().publish_title_button_share,children:[(0,g.jsx)(c.Z,{className:_().icon_lock}),"SHARE FORM AS A TEMPLATE"]})}}()}),""===pe&&(0,g.jsx)("div",{className:_().publish_button_area,children:(0,g.jsx)("button",{className:_().publish_button,onClick:function(){var t;if(xe()){var l=e.contract,n=new Set(A),_=new Set(H),u=F,a=i.id;"public"===N.id&&(n=new Set,_=new Set,u=0),se(!0);var o=j.utils.format.parseNearAmount("".concat(u));null===l||void 0===l||null===(t=l.publish_form)||void 0===t||t.call(l,{formId:a,limit_participants:parseInt(I||0),enroll_fee:o,start_date:X,end_date:$,black_list:(0,s.Z)(n),white_list:(0,s.Z)(_)}).then((function(e){if(e){var t=new URL(window.location.href).origin;de("".concat(t,"/form/form-answer?id=").concat(a)),me({type:"success",msg:"Form has been published"})}else me({type:"error",msg:"Somethings went wrong, please try again!"})})).catch((function(e){me({type:"error",msg:String(e)})}))}},children:"Publish"})}),""!==pe&&(0,g.jsx)("div",{className:_().publish_button_area,children:(0,g.jsx)("button",{className:_().publish_button,onClick:function(){t.back()},children:"Go back"})})]}),(0,g.jsx)("div",{className:_().line}),""!==pe&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:_().publish_share_label,children:"Link to share:"}),(0,g.jsxs)("div",{className:_().publish_row,children:[(0,g.jsx)(r.Z,{className:_().publish_icon_link}),(0,g.jsx)("div",{className:_().publish_link_input,children:pe}),(0,g.jsx)("div",{className:_().publish_link_copy,onClick:function(){navigator.clipboard.writeText(pe),me({type:"success",msg:"copied"})},children:"Copy link"})]})]}),[{id:"private",title:"PRIVATE FORM",sub:"Only available to invited people"},{id:"public",title:"PUBLIC FORM",sub:"Available to everyone"}].map((function(e,t){return(0,g.jsxs)("div",{className:_().publish_status_content+" "+je(e.id),onClick:function(){return function(e){y(e.id),"share"===e.id&&S(!0)}(e)},children:[(0,g.jsx)("div",{className:_().publish_status_title,children:e.title}),(0,g.jsx)("div",{className:_().publish_status_sub,children:e.sub}),N===e.id&&(0,g.jsx)(o.Z,{className:_().publish_icon_check})]},t)})),(0,g.jsxs)("div",{className:_().publish_row_input,style:{height:"private"===N?64:0},children:[(0,g.jsx)("input",{className:_().publish_black_input,value:W,onChange:function(e){J(e.target.value)},placeholder:"Enter black list"}),(0,g.jsx)("div",{className:_().publish_black_button,onClick:function(){""!==W?H.includes(W)?me({type:"error",msg:"This account has been already defined in white list"}):(me({type:"success",msg:"Added ".concat(W," into black list")}),A.push(W),z((0,s.Z)(A)),J("")):me({type:"error",msg:"Black list account could not be empty"})},children:"Add to Black List"}),(0,g.jsx)("input",{className:_().publish_black_input,value:q,onChange:function(e){G(e.target.value)},placeholder:"Enter white list"}),(0,g.jsx)("div",{className:_().publish_white_button,onClick:function(){""!==q?A.includes(q)?me({type:"error",msg:"This account has been already defined in black list"}):(me({type:"success",msg:"Added ".concat(q," into white list")}),H.push(q),U((0,s.Z)(H)),G("")):me({type:"error",msg:"White list account could not be empty"})},children:"Add to White List"})]}),(0,g.jsxs)("div",{className:_().publish_fee_row+" "+_().margin_top,children:[(0,g.jsx)("div",{className:_().publish_fee_label,children:"Limit participant"}),(0,g.jsx)("input",{className:_().publish_fee_input,type:"number",onChange:function(e){D(e.target.value)},placeholder:"Leave blank if you don't want to the limitation"})]}),(0,g.jsxs)("div",{className:_().publish_fee_row,children:[(0,g.jsx)("div",{className:_().publish_fee_label,children:"Joining Fee"}),(0,g.jsx)("button",{className:O?_().publish_fee_button_active:_().publish_fee_button,onClick:function(){return Z(!0)},children:"Free"}),(0,g.jsx)("button",{className:O?_().publish_fee_button:_().publish_fee_button_active,onClick:function(){return Z(!1)},children:"Paid"}),!O&&(0,g.jsx)("input",{className:_().publish_fee_input,type:"number",onChange:function(e){R(e.target.value)},placeholder:"The amount need to be paid by a participant"})]}),(0,g.jsxs)("div",{className:_().publish_fee_row,children:[(0,g.jsx)("div",{className:_().publish_fee_label,children:"Starting time"}),(0,g.jsx)("input",{className:_().publish_fee_input_date,type:"datetime-local",onChange:function(e){var t=new Date(e.target.value);Y(t.getTime().toString())}}),(0,g.jsx)("div",{className:_().publish_fee_label_paid,children:"Ending time"}),(0,g.jsx)("input",{className:_().publish_fee_input_date,type:"datetime-local",onChange:function(e){var t=new Date(e.target.value);ee(t.getTime().toString())}})]})]}),"private"===N&&(0,g.jsxs)("div",{className:_().list,children:[(0,g.jsx)("div",{className:_().list_label,children:"Black list:"}),(0,g.jsx)("div",{className:_().list_content,children:(null===A||void 0===A?void 0:A.length)>0?(0,g.jsx)(g.Fragment,{children:A.map((function(e){return(0,g.jsx)(ge,{children:(0,g.jsx)(d.Z,{label:e,onDelete:function(){return t=e,void z((0,s.Z)(A.filter((function(e){return e!==t}))));var t},variant:"outlined",color:"error"})},e)}))}):(0,g.jsx)("div",{className:_().list_nothing,children:"Nothing to display"})}),(0,g.jsx)("div",{className:_().list_label,children:"White list:"}),(0,g.jsx)("div",{className:_().list_content,children:(null===H||void 0===H?void 0:H.length)>0?(0,g.jsx)(g.Fragment,{children:H.map((function(e){return(0,g.jsx)(ge,{children:(0,g.jsx)(d.Z,{label:e,onDelete:function(){return t=e,void U((0,s.Z)(H.filter((function(e){return e!==t}))));var t},variant:"outlined",color:"success"})},e)}))}):(0,g.jsx)("div",{className:_().list_nothing,children:"Nothing to display"})})]}),(0,g.jsx)(h.Z,{open:k,onClose:ve,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,g.jsxs)(b.Z,{sx:P,children:[(0,g.jsx)(p.Z,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Share form as template"}),(0,g.jsxs)("div",{className:_().publish_modal_content,children:[(0,g.jsxs)("div",{className:_().publish_modal_row,children:[(0,g.jsx)("div",{className:_().publish_modal_label,children:"Template Title"}),(0,g.jsx)("input",{className:_().publish_modal_input,placeholder:"Enter title here"})]}),(0,g.jsxs)("div",{className:_().publish_modal_row,children:[(0,g.jsx)("div",{className:_().publish_modal_label,children:"Description"}),(0,g.jsx)("textarea",{className:_().publish_modal_textarea,rows:5,placeholder:"Enter description here"})]}),(0,g.jsxs)("div",{className:_().publish_invite_row_button,children:[(0,g.jsx)("button",{className:_().publish_modal_button,onClick:ve,children:"Cancel"}),(0,g.jsx)("button",{className:_().publish_modal_button_share,children:"Share"})]})]})]})})]})]})}},15322:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/form/publish-form",function(){return i(71815)}])},37196:function(e){e.exports={snack_area:"Notify_snack_area__VKRcf"}},53444:function(e){e.exports={root:"Publish_root__Yr4R3",publish_content:"Publish_publish_content__2qRpE",publish_title:"Publish_publish_title__lKxtk",publish_title_text:"Publish_publish_title_text__B_5AP",publish_title_status:"Publish_publish_title_status__6teoy",publish_title_button:"Publish_publish_title_button__QRqw5",publish_title_button_share:"Publish_publish_title_button_share__YxlBS",publish_title_button_public:"Publish_publish_title_button_public__rk3az",publish_button_area:"Publish_publish_button_area__l43fG",publish_button:"Publish_publish_button__P_wDI",publish_share_label:"Publish_publish_share_label__gGs0n",icon_lock:"Publish_icon_lock___z_7c",publish_row:"Publish_publish_row__TeXKV",publish_icon_link:"Publish_publish_icon_link__LyK8y",publish_link_input:"Publish_publish_link_input__tzdRz",publish_link_copy:"Publish_publish_link_copy__948om",publish_status_content:"Publish_publish_status_content__foP26",publish_status_content_active_public:"Publish_publish_status_content_active_public__8XPYU",publish_status_content_active_private:"Publish_publish_status_content_active_private__QmInh",publish_status_content_active_share:"Publish_publish_status_content_active_share__hhmaW",publish_status_title:"Publish_publish_status_title__mRFhz",publish_invite:"Publish_publish_invite__bZxcL",publish_status_sub:"Publish_publish_status_sub__VcOc2",publish_icon_check:"Publish_publish_icon_check__I7HXI",publish_invite_content:"Publish_publish_invite_content__ogsdk",publish_invite_email_icon:"Publish_publish_invite_email_icon__UTHmf",publish_invite_label:"Publish_publish_invite_label__luKtH",publish_invite_input:"Publish_publish_invite_input__bBbNb",publish_invite_onfocus:"Publish_publish_invite_onfocus__J5Oyl",publish_invite_message:"Publish_publish_invite_message__YjufJ",publish_invite_row_button:"Publish_publish_invite_row_button__cBFL1",publish_invite_button:"Publish_publish_invite_button__DNV5R",publish_invite_button_send:"Publish_publish_invite_button_send__HYJNE",publish_modal_content:"Publish_publish_modal_content__vsfaf",publish_modal_row:"Publish_publish_modal_row__Qum83",publish_modal_label:"Publish_publish_modal_label__PP_YI",publish_modal_input:"Publish_publish_modal_input__tprQ2",publish_modal_textarea:"Publish_publish_modal_textarea__Rxyjr",publish_modal_button:"Publish_publish_modal_button__w42SF",publish_modal_button_share:"Publish_publish_modal_button_share__UOpzu",line:"Publish_line__ynkjp",margin_top:"Publish_margin_top__IEbtx",publish_fee_row:"Publish_publish_fee_row__r8fLD",publish_fee_label:"Publish_publish_fee_label__4pIxb",publish_fee_input:"Publish_publish_fee_input__nmyfa",publish_fee_button:"Publish_publish_fee_button__G_brv",publish_fee_button_active:"Publish_publish_fee_button_active__X9S_d",publish_fee_label_paid:"Publish_publish_fee_label_paid__1_lf8",publish_fee_input_date:"Publish_publish_fee_input_date__8X_2a",publish_row_input:"Publish_publish_row_input__N15J6",publish_black_input:"Publish_publish_black_input__k023a",publish_black_button:"Publish_publish_black_button___l1ej",publish_white_button:"Publish_publish_white_button__VIT_d",list:"Publish_list__VCZde",list_label:"Publish_list_label__wDjk_",list_content:"Publish_list_content__jqa40",list_nothing:"Publish_list_nothing__jOH25"}}},function(e){e.O(0,[7739,6775,4190,9774,2888,179],(function(){return t=15322,e(e.s=t);var t}));var t=e.O();_N_E=t}]);