(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6410],{25802:function(e,t,i){"use strict";i.d(t,{Z:function(){return d}});var s=i(67294),l=i(76798),n=i(59499),_=i(15568),u=i(85893);function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}var o=s.forwardRef((function(e,t){return(0,u.jsx)(_.Z,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({elevation:6,ref:t,variant:"filled"},e))})),r=o,c=i(77227),h=function(e){var t=e.open;return(0,u.jsx)(c.Z,{sx:{color:"#fff",zIndex:9999},open:t,children:(0,u.jsx)("img",{src:"/loadingWhite.svg",style:{width:100,height:100},alt:"img"})})},b=i(37196),p=i.n(b),d=function(e){var t=e.openSnack,i=e.snackMsg,s=e.alertType,n=e.openLoading,_=e.onClose;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(h,{open:n}),(0,u.jsx)(l.Z,{open:t,anchorOrigin:{vertical:"top",horizontal:"right"},className:p().snack_area,autoHideDuration:3e3,onClose:_,children:(0,u.jsx)(r,{onClose:_,sx:{width:"100%"},severity:s,children:i})})]})}},71407:function(e,t,i){"use strict";i.r(t);var s=i(50029),l=i(9632),n=i(87794),_=i.n(n),u=i(67294),a=i(81997),o=i.n(a),r=i(73340),c=i(63845),h=i(60888),b=i(36185),p=i(59739),d=i(86983),m=i(87357),v=i(15861),f=i(87918),x=i(11496),j=i(11163),g=i(25617),P=i(25802),N=i(68447),y=i(85893),w={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:600,bgcolor:"#fff",borderRadius:"24px",boxShadow:24,p:4,outline:"none"},k=function(e){var t=e.id,i=(0,j.useRouter)(),s=(0,g.v9)((function(e){return e.wallet})),n=(0,u.useState)("private"),_=n[0],a=n[1],k=(0,u.useState)(!1),C=k[0],E=k[1],Z=(0,u.useState)(!0),O=Z[0],T=Z[1],L=(0,u.useState)("0"),I=L[0],R=L[1],A=(0,u.useState)([]),F=A[0],W=A[1],D=(0,u.useState)([]),J=D[0],H=D[1],M=(0,u.useState)(""),U=M[0],B=M[1],K=(0,u.useState)(""),V=K[0],Q=K[1],Y=(0,u.useState)(""),q=Y[0],z=Y[1],G=(0,u.useState)(""),X=G[0],$=G[1],ee=(0,u.useState)(0),te=ee[0],ie=ee[1],se=(0,u.useState)(!1),le=se[0],ne=se[1],_e=(0,u.useState)(!1),ue=_e[0],ae=_e[1],oe=(0,u.useState)("success"),re=oe[0],ce=oe[1],he=(0,u.useState)(""),be=he[0],pe=he[1],de=(0,u.useState)(""),me=de[0],ve=de[1],fe=function(e){var t=e.type,i=e.msg;ae(!0),ne(!1),ce(t),pe(i)};(0,u.useEffect)((function(){return xe(),function(){localStorage.removeItem("myForms")}}),[]);var xe=function(){var e,l=s.contract,n=(s.walletConnection,""),_=encodeURIComponent(n);null!==t&&""!==t&&"undefined"!==typeof t||(n="Could not found any object have that id!",i.push("/error?content=".concat(_))),null===l||void 0===l||null===(e=l.get_event)||void 0===e||e.call(l,{id:t}).then((function(e){if(e){var t,l=e.owner;(null===s||void 0===s||null===(t=s.accounts[0])||void 0===t?void 0:t.address)!==l&&(n="You do not have permssion to edit this form yet!"),0!==e.status&&(n="Event has been published before!"),""!==n&&(_=encodeURIComponent(n),i.push("/error?content=".concat(_)))}})).catch((function(e){console.log(e)}))},je=function(){E(!1)},ge=function(){if(I<0)return fe({type:"error",msg:"enroll fee could be negative"}),!1;if(te<0)return fe({type:"error",msg:"limited participant could be negative"}),!1;if(""===q||"undefined"===typeof q||null===q)return fe({type:"error",msg:"starting time could not be empty"}),!1;if(""===X||"undefined"===typeof X||null===X)return fe({type:"error",msg:"ending date could not be empty"}),!1;if(X<q)return fe({type:"error",msg:"ending date could not less than starting date"}),!1;var e=Date.now();return!(X<e)||(fe({type:"error",msg:"ending date could not less than current time"}),!1)},Pe=function(e){if(_===e){var t="publish_status_content_active_"+e;return o()[t]}},Ne=(0,x.ZP)("div")((function(e){return{margin:e.theme.spacing(1)}}));return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(P.Z,{openLoading:le,openSnack:ue,alertType:re,snackMsg:be,onClose:function(){ae(!1)}}),(0,y.jsxs)("div",{className:o().root,children:[(0,y.jsxs)("div",{className:o().publish_content,children:[(0,y.jsxs)("div",{className:o().publish_title,children:[(0,y.jsx)("div",{className:o().publish_title_text,children:"Publish Event"}),(0,y.jsx)("div",{className:o().publish_title_status,children:function(){switch(_){case"private":return(0,y.jsxs)("div",{className:o().publish_title_button,children:[(0,y.jsx)(c.Z,{className:o().icon_lock}),"Private Event"]});case"public":return(0,y.jsxs)("div",{className:o().publish_title_button_public,children:[(0,y.jsx)(r.Z,{className:o().icon_lock}),"Public Event"]});case"share":return(0,y.jsxs)("div",{className:o().publish_title_button_share,children:[(0,y.jsx)(p.Z,{className:o().icon_lock}),"SHARE FORM AS A TEMPLATE"]})}}()}),""===me&&(0,y.jsx)("div",{className:o().publish_button_area,children:(0,y.jsx)("button",{className:o().publish_button,onClick:function(){var e;if(ge()){var i=s.contract,n=new Set(F),u=new Set(J),a=I;"public"===_.id&&(n=new Set,u=new Set,a=0),ne(!0);var o=N.utils.format.parseNearAmount("".concat(a));null===i||void 0===i||null===(e=i.publish_event)||void 0===e||e.call(i,{eventId:t,limit_participants:parseInt(te||0),enroll_fee:o,start_date:q,end_date:X,black_list:(0,l.Z)(n),white_list:(0,l.Z)(u)}).then((function(e){if(e){var i=new URL(window.location.href).origin;ve("".concat(i,"/event/event-detail?id=").concat(t)),fe({type:"success",msg:"Event has been published"})}else fe({type:"error",msg:"Somethings went wrong, please try again!"})})).catch((function(e){fe({type:"error",msg:String(e)})}))}},children:"Publish"})}),""!==me&&(0,y.jsx)("div",{className:o().publish_button_area,children:(0,y.jsx)("button",{className:o().publish_button,onClick:function(){i.back()},children:"Go back"})})]}),(0,y.jsx)("div",{className:o().line}),""!==me&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:o().publish_share_label,children:"Link to share:"}),(0,y.jsxs)("div",{className:o().publish_row,children:[(0,y.jsx)(b.Z,{className:o().publish_icon_link}),(0,y.jsx)("div",{className:o().publish_link_input,children:me}),(0,y.jsx)("div",{className:o().publish_link_copy,onClick:function(){navigator.clipboard.writeText(me),fe({type:"success",msg:"copied"})},children:"Copy link"})]})]}),S.map((function(e,t){return(0,y.jsxs)("div",{className:o().publish_status_content+" "+Pe(e.id),onClick:function(){return function(e){a(e.id),"share"===e.id&&E(!0)}(e)},children:[(0,y.jsx)("div",{className:o().publish_status_title,children:e.title}),(0,y.jsx)("div",{className:o().publish_status_sub,children:e.sub}),_===e.id&&(0,y.jsx)(h.Z,{className:o().publish_icon_check})]},t)})),(0,y.jsxs)("div",{className:o().publish_row_input,style:{height:"private"===_?64:0},children:[(0,y.jsx)("input",{className:o().publish_black_input,value:U,onChange:function(e){B(e.target.value)},placeholder:"Enter black list"}),(0,y.jsx)("div",{className:o().publish_black_button,onClick:function(){""!==U?J.includes(U)?fe({type:"error",msg:"This account has been already defined in white list"}):(fe({type:"success",msg:"Added ".concat(U," into black list")}),F.push(U),W((0,l.Z)(F)),B("")):fe({type:"error",msg:"Black list account could not be empty"})},children:"Add to Black List"}),(0,y.jsx)("input",{className:o().publish_black_input,value:V,onChange:function(e){Q(e.target.value)},placeholder:"Enter white list"}),(0,y.jsx)("div",{className:o().publish_white_button,onClick:function(){""!==V?F.includes(V)?fe({type:"error",msg:"This account has been already defined in black list"}):(fe({type:"success",msg:"Added ".concat(V," into white list")}),J.push(V),H((0,l.Z)(J)),Q("")):fe({type:"error",msg:"White list account could not be empty"})},children:"Add to White List"})]}),(0,y.jsxs)("div",{className:o().publish_fee_row+" "+o().margin_top,children:[(0,y.jsx)("div",{className:o().publish_fee_label,children:"Limit participant"}),(0,y.jsx)("input",{className:o().publish_fee_input,type:"number",onChange:function(e){ie(e.target.value)},placeholder:"Leave blank if you don't want to the limitation"})]}),(0,y.jsxs)("div",{className:o().publish_fee_row,children:[(0,y.jsx)("div",{className:o().publish_fee_label,children:"Joining Fee"}),(0,y.jsx)("button",{className:O?o().publish_fee_button_active:o().publish_fee_button,onClick:function(){return T(!0)},children:"Free"}),(0,y.jsx)("button",{className:O?o().publish_fee_button:o().publish_fee_button_active,onClick:function(){return T(!1)},children:"Paid"}),!O&&(0,y.jsx)("input",{className:o().publish_fee_input,type:"number",onChange:function(e){R(e.target.value)},placeholder:"The amount need to be paid by a participant"})]}),(0,y.jsxs)("div",{className:o().publish_fee_row,children:[(0,y.jsx)("div",{className:o().publish_fee_label,children:"Starting time"}),(0,y.jsx)("input",{className:o().publish_fee_input_date,type:"datetime-local",onChange:function(e){var t=new Date(e.target.value);z(t.getTime().toString())}}),(0,y.jsx)("div",{className:o().publish_fee_label_paid,children:"Ending time"}),(0,y.jsx)("input",{className:o().publish_fee_input_date,type:"datetime-local",onChange:function(e){var t=new Date(e.target.value);$(t.getTime().toString())}})]})]}),"private"===_&&(0,y.jsxs)("div",{className:o().list,children:[(0,y.jsx)("div",{className:o().list_label,children:"Black list:"}),(0,y.jsx)("div",{className:o().list_content,children:(null===F||void 0===F?void 0:F.length)>0?(0,y.jsx)(y.Fragment,{children:F.map((function(e){return(0,y.jsx)(Ne,{children:(0,y.jsx)(f.Z,{label:e,onDelete:function(){return t=e,void W((0,l.Z)(F.filter((function(e){return e!==t}))));var t},variant:"outlined",color:"error"})},e)}))}):(0,y.jsx)("div",{className:o().list_nothing,children:"Nothing to display"})}),(0,y.jsx)("div",{className:o().list_label,children:"White list:"}),(0,y.jsx)("div",{className:o().list_content,children:(null===J||void 0===J?void 0:J.length)>0?(0,y.jsx)(y.Fragment,{children:J.map((function(e){return(0,y.jsx)(Ne,{children:(0,y.jsx)(f.Z,{label:e,onDelete:function(){return t=e,void H((0,l.Z)(J.filter((function(e){return e!==t}))));var t},variant:"outlined",color:"success"})},e)}))}):(0,y.jsx)("div",{className:o().list_nothing,children:"Nothing to display"})})]}),(0,y.jsx)(d.Z,{open:C,onClose:je,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,y.jsxs)(m.Z,{sx:w,children:[(0,y.jsx)(v.Z,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Share form as template"}),(0,y.jsxs)("div",{className:o().publish_modal_content,children:[(0,y.jsxs)("div",{className:o().publish_modal_row,children:[(0,y.jsx)("div",{className:o().publish_modal_label,children:"Template Title"}),(0,y.jsx)("input",{className:o().publish_modal_input,placeholder:"Enter title here"})]}),(0,y.jsxs)("div",{className:o().publish_modal_row,children:[(0,y.jsx)("div",{className:o().publish_modal_label,children:"Description"}),(0,y.jsx)("textarea",{className:o().publish_modal_textarea,rows:5,placeholder:"Enter description here"})]}),(0,y.jsxs)("div",{className:o().publish_invite_row_button,children:[(0,y.jsx)("button",{className:o().publish_modal_button,onClick:je,children:"Cancel"}),(0,y.jsx)("button",{className:o().publish_modal_button_share,children:"Share"})]})]})]})})]})]})};k.getInitialProps=function(){var e=(0,s.Z)(_().mark((function e(t){var i;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.query.id,e.abrupt("return",{id:i});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.default=k;var S=[{id:"private",title:"PRIVATE EVENT",sub:"Only available to invited people"},{id:"public",title:"PUBLIC EVENT",sub:"Available to everyone"}]},94752:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/event/publish-event",function(){return i(71407)}])},37196:function(e){e.exports={snack_area:"Notify_snack_area__VKRcf"}},81997:function(e){e.exports={root:"Publish_root__BcVjH",publish_content:"Publish_publish_content__lS1iT",publish_title:"Publish_publish_title__JNYkK",publish_title_text:"Publish_publish_title_text__euhqa",publish_title_status:"Publish_publish_title_status__YNO__",publish_title_button:"Publish_publish_title_button___oETw",publish_title_button_share:"Publish_publish_title_button_share__RShHZ",publish_title_button_public:"Publish_publish_title_button_public__snqgd",publish_button_area:"Publish_publish_button_area___7OX1",publish_button:"Publish_publish_button__L3wy0",publish_share_label:"Publish_publish_share_label__FTJhN",icon_lock:"Publish_icon_lock__xSFq3",publish_row:"Publish_publish_row__4JK4R",publish_icon_link:"Publish_publish_icon_link__mPx7t",publish_link_input:"Publish_publish_link_input__JbqN_",publish_link_copy:"Publish_publish_link_copy__fZWa1",publish_status_content:"Publish_publish_status_content__HdgQ3",publish_status_content_active_public:"Publish_publish_status_content_active_public__6_PbY",publish_status_content_active_private:"Publish_publish_status_content_active_private__ouxdh",publish_status_content_active_share:"Publish_publish_status_content_active_share__H0IzI",publish_status_title:"Publish_publish_status_title__jmB1e",publish_invite:"Publish_publish_invite__yg7WK",publish_status_sub:"Publish_publish_status_sub__bSwB7",publish_icon_check:"Publish_publish_icon_check__32xUI",publish_invite_content:"Publish_publish_invite_content__gW_PY",publish_invite_email_icon:"Publish_publish_invite_email_icon__grQu4",publish_invite_label:"Publish_publish_invite_label__LGnVi",publish_invite_input:"Publish_publish_invite_input__QpRJ5",publish_invite_onfocus:"Publish_publish_invite_onfocus__7J6te",publish_invite_message:"Publish_publish_invite_message__GuHKx",publish_invite_row_button:"Publish_publish_invite_row_button__HaFM1",publish_invite_button:"Publish_publish_invite_button__AWMQa",publish_invite_button_send:"Publish_publish_invite_button_send__vjShU",publish_modal_content:"Publish_publish_modal_content__jMTb7",publish_modal_row:"Publish_publish_modal_row__umsEj",publish_modal_label:"Publish_publish_modal_label__SSYEf",publish_modal_input:"Publish_publish_modal_input__CtS0d",publish_modal_textarea:"Publish_publish_modal_textarea__5hIuJ",publish_modal_button:"Publish_publish_modal_button__boTKt",publish_modal_button_share:"Publish_publish_modal_button_share__Rnvv4",line:"Publish_line__l6QLN",margin_top:"Publish_margin_top__JiOWo",publish_fee_row:"Publish_publish_fee_row__UzPNU",publish_fee_label:"Publish_publish_fee_label__ehW4w",publish_fee_input:"Publish_publish_fee_input__F6tbW",publish_fee_button:"Publish_publish_fee_button__ACf7s",publish_fee_button_active:"Publish_publish_fee_button_active__Juij7",publish_fee_label_paid:"Publish_publish_fee_label_paid__z0d2k",publish_fee_input_date:"Publish_publish_fee_input_date__cmsu6",publish_row_input:"Publish_publish_row_input___3IlL",publish_black_input:"Publish_publish_black_input__P6lNL",publish_black_button:"Publish_publish_black_button__Je3j4",publish_white_button:"Publish_publish_white_button__crmpM",list:"Publish_list__Vnlk5",list_label:"Publish_list_label__HKa48",list_content:"Publish_list_content__rZh5v",list_nothing:"Publish_list_nothing__QnZ8j"}}},function(e){e.O(0,[7739,6775,4190,9774,2888,179],(function(){return t=94752,e(e.s=t);var t}));var t=e.O();_N_E=t}]);